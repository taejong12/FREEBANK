-- 시스템 스키마

-- 사용자 생성
CREATE USER C##FREEBANK IDENTIFIED BY 1234;

-- CONNECT: 사용자가 DB에 접속할 수 있는 권한
-- RESOURCE: 데이터를 생성, 수정, 삭제할 수 있는 권한
GRANT CONNECT, RESOURCE TO C##FREEBANK;

-- system 에서 유저 권한 줘야 에러 없이 DB 에 저장 가능
-- QUOTA : 테이블 공간 사용
ALTER USER C##FREEBANK DEFAULT TABLESPACE USERS QUOTA UNLIMITED ON USERS;

--------------------------------------------------------------------------------------------
-- FREEBANK 스키마

-- 회원 테이블
CREATE TABLE FREEBANKUSER (
    FREEBANKUSER_ID VARCHAR2(50) PRIMARY KEY,          
    FREEBANKUSER_NAME VARCHAR2(50) NOT NULL,            
    FREEBANKUSER_PWD VARCHAR2(50) NOT NULL,   
    FREEBANKUSER_AGE NUMBER NOT NULL,                                     
    FREEBANKUSER_SEX CHAR(1),
    FREEBANKUSER_EMAIL VARCHAR2(50) NOT NULL,
    FREEBANKUSER_ADMIN CHAR(1) DEFAULT 'N' NOT NULL ,                             
    FREEBANKUSER_CREDITRATING NUMBER DEFAULT 5 NOT NULL,
    FREEBANKUSER_TOTAL NUMBER DEFAULT 0 NOT NULL,
    FREEBANKUSER_CREATE DATE DEFAULT SYSDATE,
    FREEBANKUSER_UPDATE DATE DEFAULT SYSDATE
);

--컬럼설명
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_ID IS '회원_아이디(PK)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_NAME IS '회원_이름';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_PWD IS '회원_비밀번호';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_AGE IS '회원_나이';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_SEX IS '회원_성별(X:남, Y:여)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_EMAIL IS '회원_이메일';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_ADMIN IS '회원_관리자여부(일반회원:N, 관리자:Y)(기본값: N)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_CREDITRATING IS '회원_신용등급(기본값: 5)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_TOTAL IS '회원_누적금액(기본값: 0)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_CREATE IS '회원_생성일(기본값: 현재날짜)';
COMMENT ON COLUMN FREEBANKUSER.FREEBANKUSER_UPDATE IS '회원_수정일(기본값: 현재날짜)';

-- 계좌 테이블
CREATE TABLE FREEBANKACCOUNT (
    FREEBANKACCOUNT_ACCOUNT VARCHAR2(50) PRIMARY KEY,       
    FREEBANKACCOUNT_BALANCE NUMBER DEFAULT 0 NOT NULL,      
    FREEBANKACCOUNT_CREATE DATE DEFAULT SYSDATE,            
    FREEBANKUSER_ID VARCHAR2(50) NOT NULL,                  
    CONSTRAINT FK_FREEBANKUSER FOREIGN KEY (FREEBANKUSER_ID) REFERENCES FREEBANKUSER(FREEBANKUSER_ID) ON DELETE CASCADE
);

COMMENT ON COLUMN FREEBANKACCOUNT.FREEBANKACCOUNT_ACCOUNT IS '계좌_번호(PK)';
COMMENT ON COLUMN FREEBANKACCOUNT.FREEBANKACCOUNT_BALANCE IS '계좌_잔고(기본값: 0)';
COMMENT ON COLUMN FREEBANKACCOUNT.FREEBANKACCOUNT_CREATE IS '계좌_생성일(기본값: 현재날짜)';
COMMENT ON COLUMN FREEBANKACCOUNT.FREEBANKUSER_ID IS '회원_아이디(FK)';

-- 상품 테이블
CREATE TABLE FREEBANKSHOP (
    FREEBANKSHOP_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,   
    FREEBANKSHOP_NAME VARCHAR2(50) NOT NULL,                               
    FREEBANKSHOP_CONTENTS VARCHAR2(255) NOT NULL,                           
    FREEBANKSHOP_PRICE NUMBER NOT NULL,                                     
    FREEBANKSHOP_ADMINID VARCHAR2(50) NOT NULL,                             
    FREEBANKSHOP_CREATE DATE DEFAULT SYSDATE,                               
    FREEBANKSHOP_UPDATE DATE DEFAULT SYSDATE                                
);

COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_ID IS '상품_고유번호(PK)';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_NAME IS '상품_이름';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_CONTENTS IS '상품_설명';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_PRICE IS '상품_가격';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_ADMINID IS '상품_관리자아이디';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_CREATE IS '상품_등록일(기본값: 현재날짜)';
COMMENT ON COLUMN FREEBANKSHOP.FREEBANKSHOP_UPDATE IS '상품_수정일(기본값: 현재날짜)';


--공지사항 테이블
CREATE TABLE FREEBANKBOARD (
    FREEBANKBOARD_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,     
    FREEBANKBOARD_TITLE VARCHAR2(255) NOT NULL,                              
    FREEBANKBOARD_AUTHOR VARCHAR2(50) NOT NULL,                               
    FREEBANKBOARD_CONTENT CLOB NOT NULL,                                      
    FREEBANKBOARD_CREATED DATE DEFAULT SYSDATE,                               
    FREEBANKBOARD_UPDATE DATE DEFAULT SYSDATE                                 
);

COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_ID IS '공지사항_고유번호(PK)';
COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_TITLE IS '공지사항_제목';
COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_AUTHOR IS '공지사항_작성자';
COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_CONTENT IS '공지사항_내용';
COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_CREATED IS '공지사항_작성일(기본값: 현재날짜)';
COMMENT ON COLUMN FREEBANKBOARD.FREEBANKBOARD_UPDATE IS '공지사항_수정일(기본값: 현재날짜)';


--구매내역 테이블
CREATE TABLE FREEBANKPURCHASELIST (
    FREEBANKPURCHASELIST_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,    
    FREEBANKPURCHASELIST_USERID VARCHAR2(50) NOT NULL,                              
    FREEBANKPURCHASELIST_ACCOUNT VARCHAR2(50) NOT NULL,                              
    FREEBANKPURCHASELIST_SHOPID NUMBER NOT NULL,                                    
    FREEBANKPURCHASELIST_SHOPNAME VARCHAR2(50) NOT NULL,                            
    FREEBANKPURCHASELIST_TOTALPAYMENT NUMBER NOT NULL,                              
    FREEBANKPURCHASELIST_TOTALSHOPCOUNT NUMBER NOT NULL,                            
    FREEBANKPURCHASELIST_CREATE DATE DEFAULT SYSDATE                                 
);

COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_ID IS '구매내역_고유번호(PK)';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_USERID IS '구매내역_회원아이디';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_ACCOUNT IS '구매내역_계좌번호';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_SHOPID IS '구매내역_상품번호';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_SHOPNAME IS '구매내역_상품이름';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_TOTALPAYMENT IS '구매내역_총결제금액';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_TOTALSHOPCOUNT IS '구매내역_총상품갯수';
COMMENT ON COLUMN FREEBANKPURCHASELIST.FREEBANKPURCHASELIST_CREATE IS '구매내역_결제일(기본값: 현재날짜)';


